$(document).ready(function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$("#message").on("hide.bs.modal",function(){$("#frmMessage").trigger("reset")});var e="",t="";$("#list").on("click",".open-modal",function(){var a=$(this).val(),n=$(this).attr("id");t=n,e=a,$("#message").modal("show")}),$("#list").on("click",".btn-delete",function(){var e=$(this).val();swal({title:"Are you sure?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-warning",confirmButtonText:"Remove",cancelButtonText:"Cancel",closeOnConfirm:!1,allowOutsideClick:!0,showLoaderOnConfirm:!0,closeOnCancel:!0},function(t){setTimeout(function(){t&&$.ajax({url:a+"/"+e,type:"DELETE",success:function(e){if("Deleted"==e)refresh();else{var t="<div id=dp"+e.id+"><button class='btn btn-warning btn-xs back' value="+e.id+"><i class='fa fa-undo'></i> Undo</button></div>";$("#dp"+e.id).replaceWith(t),swal({title:"Removed!",text:"<center>"+e.description+" is Removed</center>",type:"success",timer:1e3,showConfirmButton:!1,html:!0})}},error:function(e){}})},500)})}),$("#list").on("click",".back",function(){var e=$(this).val();$(this).attr("id");swal({title:"Are you sure?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Undo",cancelButtonText:"Cancel",closeOnConfirm:!1,allowOutsideClick:!0,showLoaderOnConfirm:!0,closeOnCancel:!0},function(t){setTimeout(function(){t&&$.get(a+"/"+e+"/edit",function(e){var t="<div id=dp"+e.id+"><button class='btn btn-info btn-xs btn-view' value="+e.id+"><i class='fa fa-file-pdf-o'></i> PDF</button> <button class='btn btn-success btn-xs btn-detail open-modal' value="+e.id+"><i class='fa fa-share'></i> Receive</button> <button class='btn btn-danger btn-xs btn-delete' value="+e.id+"><i class='fa fa-remove'></i> Cancel</button></div>";$("#dp"+e.id).replaceWith(t),swal({title:"Cancelled!",text:"<center>"+e.description+" is Cancelled</center>",type:"success",timer:1e3,showConfirmButton:!1,html:!0})})},500)})});var a="/coordinator/token",n=$("#achievement-table").DataTable({processing:!0,serverSide:!0,columnDefs:[{width:"220px",targets:4},{width:"150px",targets:3}],ajax:{type:"POST",url:a,data:function(e){e.strUserFirstName=$("#strUserFirstName").val(),e.strUserMiddleName=$("#strUserMiddleName").val(),e.strUserLastName=$("#strUserLastName").val(),e.intDistID=$("#intDistID").val(),e.intCounID=$("#intCounID").val(),e.intBaraID=$("#intBaraID").val(),e.intBatcID=$("#intBatcID").val(),e.strPersStreet=$("#strPersStreet").val(),e.strPersReligion=$("#strPersReligion").val()}},columns:[{data:"strStudName",name:"strStudName"},{data:"description",name:"achievements.description"},{data:"place_held",name:"achievements.place_held"},{data:"date_held",name:"achievements.date_held"},{data:"action",name:"action",orderable:!1,searchable:!1}]});$("#btn-advSearch").on("click",function(e){n.draw(),e.preventDefault(),$("#frmAdv").trigger("reset"),$("#advanced_search").modal("hide")}),$("#advanced_search").on("hide.bs.modal",function(){$("#frmAdv").trigger("reset")}),$("#advsearch").click(function(){$("#advanced_search").modal("show")}),$("#btn-message").click(function(){if($("#frmMessage").parsley().destroy(),$("#frmMessage").parsley().isValid()){$("#btn-message").attr("disabled","disabled"),setTimeout(function(){$("#btn-message").removeAttr("disabled")},1e3);var s={title:$("#title").parsley("data-parsley-whitespace","squish").getValue(),description:$("#description").parsley("data-parsley-whitespace","squish").getValue(),id:t},i=a+"/"+e;$.ajax({type:"PUT",url:i,data:s,dataType:"json",success:function(e){$("#message").modal("hide"),n.draw(),swal({title:"Success!",text:"<center>"+e.title+" is Stored</center>",type:"success",timer:1e3,showConfirmButton:!1,html:!0})},error:function(e){$.notify({icon:"fa fa-warning",message:e.responseText.replace(/['"]+/g,"")},{type:"warning",z_index:2e3,delay:5e3})}})}})});