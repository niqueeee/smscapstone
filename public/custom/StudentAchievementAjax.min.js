$(document).ready(function(){$("#btn-add").click(function(){$("#txt").text("Add Achivement"),$("#btn-save").val("add"),$("#frmAchievement").trigger("reset"),$("#add_achievement").modal("show")});var e="/student/achievements",t=new Date;t.setFullYear((new Date).getFullYear()),$("#datepicker").datepicker({viewMode:"years",endDate:t,autoclose:!0,format:"yyyy-mm-dd"});var a=$("#achievement-table").DataTable({responsive:!0,processing:!0,serverSide:!0,ajax:dataurl,columnDefs:[{width:"180px",targets:5},{width:"70px",targets:4},{width:"70px",targets:3},{width:"150px",targets:2}],columns:[{data:"description",name:"description"},{data:"place_held",name:"place_held"},{data:"date_held",name:"date_held"},{data:"status",name:"status",searchable:!1},{data:"token_process",name:"token_process",searchable:!1},{data:"action",name:"action",orderable:!1,searchable:!1}]});$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$("#add_achievement").on("hidden.bs.modal",function(){$("#frmAchivement").trigger("reset"),$("#frmAchivement").parsley().destroy()}),$("#list").on("click",".open-modal",function(){var t=$(this).val();id=t,$.get(e+"/"+t+"/edit",function(e){"Deleted"==e?refresh():($("h4").text("Edit Achivement"),$("#description").val(e.description),$("#place_held").val(e.place_held),$("#datepicker").val(e.date_held),$("#btn-save").val("update"),$("#add_achievement").modal("show"))})}),$("#list").on("click",".btn-delete",function(){var t=$(this).val();swal({title:"Are you sure?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Delete",cancelButtonText:"Cancel",closeOnConfirm:!1,allowOutsideClick:!0,showLoaderOnConfirm:!0,closeOnCancel:!0},function(n){setTimeout(function(){n&&$.ajax({url:e+"/"+t,type:"DELETE",success:function(e){a.draw(),swal({title:"Deleted!",text:"<center>Data Deleted</center>",type:"success",timer:1e3,showConfirmButton:!1,html:!0})},error:function(e){swal({title:"Failed!",text:"<center>"+e.responseText.replace(/['"]+/g,"")+"</center>",type:"error",confirmButtonClass:"btn-success",showConfirmButton:!0,html:!0})}})},500)})}),$("#btn-save").click(function(){if($("#frmAchivement").parsley().destroy(),$("#frmAchivement").parsley().isValid()){$("#btn-save").attr("disabled","disabled"),setTimeout(function(){$("#btn-save").removeAttr("disabled")},1e3);var t=new FormData($("#frmAchivement")[0]),n=$("#btn-save").val(),s=e;"update"==n&&(s+="/"+id),$.ajax({type:"POST",url:s,data:t,processData:!1,dataType:"json",contentType:!1,success:function(e){$("#add_achievement").modal("hide"),a.draw(),swal({title:"Success!",text:"<center>"+e.description+" is Stored</center>",type:"success",timer:1e3,showConfirmButton:!1,html:!0})},error:function(e){$.notify({icon:"fa fa-warning",message:e.responseText.replace(/['"]+/g,"")},{type:"warning",z_index:2e3,delay:5e3})}})}})});